<!DOCTYPE HTML><html><head>

<meta charset="utf8"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"><title>Directives - modulojs.org</title><link rel="stylesheet" href="/_modulo/modulo-bundle-xj5723r.css"></head><body>


    
    
    
    

    <!-- Some global CSS that is not tied to any component: -->
    



<slot name="above-navbar"></slot>

<nav class="Navbar">
    <a href="/index.html" class="Navbar-logo"><img src="/img/modulo_logo.svg" style="height:70px" alt="Modulo"></a>
    <a href="/index.html" class="Navbar-tinyText">[%] Modulo.js</a>
    <ul>
        <li>
            <a href="/index.html#about">About</a>
        </li>
        <li>
            <a href="/start.html">Start</a>
        </li>
        <li>
            <a href="/docs/" class="Navbar--selected">Docs</a>
        </li>
    </ul>

    <div class="Navbar-rightInfo">
        
        
            v: 0.0.13<br>
            <!--SLOC: undefined lines<br />-->
            <a href="https://github.com/michaelpb/modulo/">github</a> |
            <a href="https://www.npmjs.com/package/mdu.js">npm mdu.js</a>
        
    
        <!--
        
            <a href="https://github.com/michaelpb/modulo/">Source Code
                <br />
                (on GitHub)
            </a>
        
        -->
    </div>
</nav>


    <main class="Main Main--fluid Main--withSidebar">
        <aside class="TitleAside TitleAside--navBar">
            <h3><span alt="Lower-case delta">%</span></h3>
            <nav class="TitleAside-navigation">
                <h3>Documentation</h3>
                <mws-docsidebar path="directives.html" modulo-original-html=""><ul>
    
        <li class="
            
            "><a href="/docs/">Table of Contents</a>
            
        </li>
    
        <li class="
            
                ginactive
            
            "><a href="/docs/tutorial_part1.html">Tutorial</a>
            
        </li>
    
        <li class="
            
                ginactive
            
            "><a href="/docs/templating.html">Templating</a>
            
        </li>
    
        <li class="
            
                ginactive
            
            "><a href="/docs/templating-reference.html">Template Reference</a>
            
        </li>
    
        <li class="
            
                ginactive
            
            "><a href="/docs/cparts.html">CParts</a>
            
        </li>
    
        <li class="
            
                ginactive
            
            "><a href="/docs/lifecycle.html">Lifecycle</a>
            
        </li>
    
        <li class="
            
                gactive
            
            "><a href="/docs/directives.html">Directives</a>
            
                
                    <ul>
                    
                        <li><a href="/docs/directives.html#directives">Directives</a>
                        
                        </li>
                    
                        <li><a href="/docs/directives.html#builtin">Built-in directives</a>
                        
                        </li>
                    
                        <li><a href="/docs/directives.html#custom">Custom directives</a>
                        
                        </li>
                    
                    </ul>
                
            
        </li>
    
        <li class="
            
                ginactive
            
            "><a href="/demos/">Examples</a>
            
        </li>
    


    <!--
    <li>
        Other resources:

        <ul>
            <li>
                <a href="/docs/faq.html">FAQ</a>
            <li title="Work in progress: Finalizing source code and methodically annotating entire file with extensive comments.">
                Literate Source*<br /><em>* Coming soon!</em>
            </li>
        </ul>

    </li>
    -->
    <!--<a href="/literate/src/Modulo.html">Literate source</a>-->
</ul>

</mws-docsidebar>
            </nav>
        </aside>
        <aside style="border:none">
            <slot>

<h1>Directives</h1>

<p><em>Directives</em> are one of the core features of Modulo. It allows for
callbacks to be triggered when a particular DOM element is "mounted" or first
appears in the DOM. It allows for your custom code to access references to DOM
nodes created after rendering.</p>

<mws-section name="directives" modulo-original-html="Introduction to directives">
        <a class="secanchor" title="Click to focus on this section." id="directives" name="directives" href="#directives">#</a>
        <h2>Introduction to directives</h2>
    </mws-section>

<p>Every directive has a name. Every directive is specified as an attribute on
the DOM element that you wish to gain access to, by enclosing the name in
square brackets. For example, the <em>State</em> CPart has the directive named
<code>bind</code>, making the full attribute be <code>[state.bind]</code>. Some
directives have shortcut names. For example, <code>[component.event]</code> can
be shortened to only a single at-sign, <code>@</code>.</p>

<p>Directives also have callback functions. Just like lifecycle callbacks, a
directive callback name is created by suffixing a string to the end of the name
of the directive. Unlike lifecycle callback functions, directive callback
functions end with <code>Mount</code> and <code>Unmount</code>.</p>

<h3>Built-in directives vs custom directives</h3>

<p>Modulo ships with a total of 4 built-in directives, defined by the built-in
<em>CParts</em> (1 from <em>State</em> and 3 from <em>Component</em>).
Typically, the built-in directives are all you need. However, just like with
lifecycle functions, the <em>Script</em> CPart also exposes the directive
interface to component developers. This is so that you can create custom
directives in a component to access the DOM after rendering.</p>


<mws-section name="builtin" modulo-original-html="Built-in directives">
        <a class="secanchor" title="Click to focus on this section." id="builtin" name="builtin" href="#builtin">#</a>
        <h2>Built-in directives</h2>
    </mws-section>

<p>Modulo ships with a total of 4 built-in directives, defined by the built-in
<em>CParts</em> (1 from <em>State</em> and 3 from <em>Component</em>).</p>

<ul>
    <li><code>[component.dataProp]</code> (<em>shortcut:</em> suffix <code>:</code>) -
    Attach data to a DOM element's `.dataProp` object, which can be used to
    directly pass <code>renderObj</code> values as <em>Props</em> or
    events
        <ul>
            <li>Symbols: <code>ev:=script.gotClicked</code>,
                <code>data:=state.dataArray</code>,
                <code>blogs:=props.blogArray</code> etc - Data-props can attach
                any values that are exposed in the
                <code>renderObj</code> by any CPart in your component. Use
                JavaScript reference notation, e.g.
                <code>state.objdata.prop1</code> would access something like
                <code>&lt;State&nbsp;objdata:='{"prop1":&nbsp;"my&nbsp;data"}'&gt;</code>
            </li>
            <li>Primitives: <code>arr:=[]</code>, <code>obj:={}</code>
            <code>boo:=true</code>, <code>num:=3</code>, etc -
            The data-prop can also be used to attach any data in JSON format
            (whatever "JSON.parse" can parse).</li>
        </ul>
    </li>

    <li><code>[component.event]</code> (<em>shortcut:</em> prefix <code>@</code>) -
    Attach event listeners to DOM elements, and remove them when the DOM
    elements are removed. (For jQuery users, this is used for similar purposes
    as "live" (delegated) events, but is faster.)
        <ul>
            <li><code>payload=...</code> - By assigning to the "payload"
            property, either with a regular HTML attribute or a <code>:=</code>
            data-prop, you can provide extra arguments to events.</li>
            <li><code>click.payload=...</code>,
            <code>mouseover.payload=...</code>, etc - If you have multiple
            events attached, you can attach separate payloads by prefixing the
            "payload" attribute with the name of the event followed by a
            dot.</li>
        </ul>
    </li>

    <li><code>[component.slot]</code> - Reattach the original child elements
    that this component had when it was first mounted to a new DOM element.
    (For React users, this is similar to doing
    <code>{this.props.children}</code>.)</li>

    <li><code>[state.bind]</code> - Two-way binding with <em>State</em>
    data, with the key determined by the <code>name=</code> property of
    whatever it is attached to.</li>
</ul>


<p>Important directive facts: Directives are discovered during the
<code>reconcile</code> lifecycle phase when DOM reconciliation is occurring, and
invoked during the <code>update</code> phase. Note that they are independent
of the <em>Template</em> CPart: You can have a component that has no
<em>Template</em> but still may employ directives, e.g. if it generates HTML
contents some other way.</p>




<mws-section name="custom" modulo-original-html="Custom directives">
        <a class="secanchor" title="Click to focus on this section." id="custom" name="custom" href="#custom">#</a>
        <h2>Custom directives</h2>
    </mws-section>


<blockquote><p><strong>Custom directives are like "refs"</strong> - Directives
have the same uses as Refs in <a href="https://reactjs.org/docs/refs-and-the-dom.html" target="_blank">React</a>: “Managing focus, text selection, or media
playback, triggering imperative animations, or integrating with third-party DOM
libraries.”</p></blockquote>

<p>Custom directives are used for direct access to the DOM. They are invoked
when a particular element is first rendered on the screen (<code>Mount</code>),
invoked when that attribute has any changes (e.g. the value gets changed, also
<code>Mount</code>), and also invoked when about to be removed from the
document (<code>Unmount</code>). This allows you to do custom set-up or
tear-down code for particular elements, such as to attach third-party
JavaScript frameworks in a convenient manner.</p>

<p>Custom directives can be easily registered in <em>Script</em> CParts simply
by defining a function with a certain name. For example, for a directive called
<code>myinput</code> directive, you can create a function called
<code>function&nbsp;myinputMount(opts)&nbsp;{</code>. A full, working example
is below, which uses a custom directive to focus on an input when a button is
clicked:</p>

<p><strong>Example custom directives:</strong></p>

<mws-demo demotype="minipreview" text="
<Template>
{# [script.myinput] is a custom directive, defined below #}
<input [script.myinput] />

{# [component.event] is a built-in directive (shortcut is @) #}
<button [component.event]click:=script.showInfo>
    Click me
</button>
</Template>

<Script>
    function myinputMount(mountOptions) {
        element.inputRef = mountOptions.el;
        // Try uncommenting the following to see data:
        //console.log(&quot;myinputMount:&quot;, mountOptions);
    }
    function showInfo(el) {
        alert(&quot;Focusing on:&quot; + String(element.inputRef));
        element.inputRef.focus();
    }
</Script>
" modulo-original-html=""><div @mouseenter:="script.rerenderFirstTime" class="demo-wrapper
             demo-wrapper__minipreview
        
        
        demo-wrapper__notabs     
        
    ">
    

    <div class="editor-toolbar">
        <p style="font-size: 11px; width: 120px; margin-right: 10px; text-align: right;
                     display: none; ">
            <em>Note: This is meant for exploring features. Your work will not be saved.</em>
        </p>

        

        
            <button class="m-Btn" title="Copy the code to make this component" @click:="script.doCopy" payload:="true">
                <span alt="Copy component symbol">‹⬡›</span>
            </button>&nbsp;
        

        
            <!--
            <button class="m-Btn demo-fs-button"
                    title="Toggle full screen view of code" @click:=script.doFullscreen>
                
                    <span alt="Go Full Screen">&nearr;</span>
                
            </button>
            &nbsp;
            -->
            <button class="m-Btn" title="Run a preview of this code" @click:="script.doRun">
                Run <span alt="Refresh">⟳</span>
            </button>
        

    </div>

    <div class="side-by-side-panes">
        <div class="editor-wrapper">
            <div [script.codemirror]="" modulo-ignore=""><div class="CodeMirror cm-s-eclipse" translate="no"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 34px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="width: 18px; pointer-events: none; display: block; bottom: 0px;"><div style="min-width: 1px; height: 449px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true" style="display: block; right: 0px; left: 30px; height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 536.297px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: 0px; border-right-width: 50px; min-height: 449px; min-width: 536.297px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>21</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">Template</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">{# [script.myinput] is a custom directive, defined below #}</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">[script.myinput]</span> <span class="cm-tag cm-bracket">/&gt;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">{# [component.event] is a built-in directive (shortcut is @) #}</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span> <span class="cm-attribute">[component.event]click:</span>=<span class="cm-string">script.showInfo</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    Click me</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">Template</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">Script</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">function</span> <span class="cm-def">myinputMount</span>(<span class="cm-def">mountOptions</span>) {</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">element</span>.<span class="cm-property">inputRef</span> <span class="cm-operator">=</span> <span class="cm-variable-2">mountOptions</span>.<span class="cm-property">el</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-comment">// Try uncommenting the following to see data:</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-comment">//console.log("myinputMount:", mountOptions);</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    }</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">function</span> <span class="cm-def">showInfo</span>(<span class="cm-def">el</span>) {</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">alert</span>(<span class="cm-string">"Focusing on:"</span> <span class="cm-operator">+</span> <span class="cm-variable">String</span>(<span class="cm-variable">element</span>.<span class="cm-property">inputRef</span>));</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">element</span>.<span class="cm-property">inputRef</span>.<span class="cm-property">focus</span>();</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 50px; width: 1px; border-bottom: 0px solid transparent; top: 449px;"></div><div class="CodeMirror-gutters" style="height: 499px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div>
        </div>

        
            <div class="editor-minipreview">
                <div modulo-ignore="">
                    <e1g1-democomponent modulo-original-html="">

<input [script.myinput]="">


<button [component.event]click:="script.showInfo">
    Click me
</button>
</e1g1-democomponent>
                </div>
            </div>
        

    </div>
</div>



</mws-demo>



<h3>Custom directive pitfalls</h3>

<p>A quick word of caution on custom directives: If you find yourself using
custom directives to do vanilla JS DOM manipulation often, you are probably
doing something wrong! They are meant as an "emergency escape hatch" to gain
access to the DOM underneath, and typically you only use them to integrate with
other libraries. The most common usage is mixing in older jQuery-style
libraries that require a reference to a DOM element. In general, it's when you
run into the limits of what Modulo is capable of doing.</p>

<h4>Directives vs. Templates for manipulating DOM</h4>

<p>Not sure which to use to manipulate the DOM and generate HTML? Short answer:
Templates! Long answer: Directives deal with direct DOM references, and thus
are almost always messier to use. Modulo's <a href="/docs/templating.html">templating system is designed</a> to generate a
string of HTML code as a purposeful limitation during the <code>render</code>
phase, and thus prevents this messiness with a stricter structure.</p>

<p>So, when you can, try to make the DOM the "source of truth", and attach data
to DOM elements via regular HTML properties or <code>:=</code>-style dataProp
properties. In other words, avoid using direct DOM manipulation as your first
approach, instead only using this "escape hatch" to vanilla JS as a last
resort.</p>


<div class="InfoBox">
    <h2>Directives and template variables</h2>

    <p>Don't get confused when attempting to mix <em>Template</em> CPart
    variables with directives.  Directives cannot access template variables,
    since directives are only are applied after the template is fully rendered
    and all template variables are already forgotten. As an example, consider
    the following code:</p>

<mws-demo text="
<Template>
    {% for athlete in state.team %}
        {# (HTML Attributes) #}
        {# Broken, will not work: #}
        <a href:=athlete.url>{{ athlete.name }}</a>

        {# Correct, will work: #}
        <a href=&quot;{{ athlete.url }}&quot;>{{ athlete.name }}</a>

        {# (Events) #}
        {# Also broken, will not work: #}
        <button @click:=athlete.myClickCallback>
            {{ athlete.name }}</button>

        {# Correct, will work: #}
        <button @click:=script.selectOne payload=&quot;{{ athlete.id }}&quot;>
            {{ athlete.name }}</button>
    {% endfor %}
</Template>
" modulo-original-html=""><div @mouseenter:="script.rerenderFirstTime" class="demo-wrapper
        
           demo-wrapper__clipboard  
        
        demo-wrapper__notabs     
        
    ">
    

    <div class="editor-toolbar">
        <p style="font-size: 11px; width: 120px; margin-right: 10px; text-align: right;
                     display: none; ">
            <em>Note: This is meant for exploring features. Your work will not be saved.</em>
        </p>

        
            <button class="m-Btn m-Btn--sm m-Btn--faded" title="Copy this code" @click:="script.doCopy">
                Copy <span alt="Clipboard">📋</span>
            </button>
        

        

        

    </div>

    <div class="side-by-side-panes">
        <div class="editor-wrapper">
            <div [script.codemirror]="" modulo-ignore=""><div class="CodeMirror cm-s-eclipse" translate="no"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" readonly="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true" style="right: 0px; left: 0px; height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 50px; min-height: 464px; min-width: 660.016px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 24px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">Template</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-tag">{%</span><span class="cm-null"> </span><span class="cm-keyword">for</span><span class="cm-null"> </span><span class="cm-variable">athlete</span><span class="cm-null"> </span><span class="cm-keyword">in</span><span class="cm-null"> </span><span class="cm-variable">state</span><span class="cm-null">.</span><span class="cm-property">team</span><span class="cm-null"> </span><span class="cm-tag">%}</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-comment">{# (HTML Attributes) #}</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-comment">{# Broken, will not work: #}</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">href:</span>=<span class="cm-string">athlete.url</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag">{{</span><span class="cm-null"> </span><span class="cm-variable">athlete</span><span class="cm-null">.</span><span class="cm-property">name</span><span class="cm-null"> </span><span class="cm-tag">}}</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-comment">{# Correct, will work: #}</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"</span><span class="cm-tag">{{</span><span class="cm-null"> </span><span class="cm-variable">athlete</span><span class="cm-null">.</span><span class="cm-property">url</span><span class="cm-null"> </span><span class="cm-tag">}}</span><span class="cm-string">"</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag">{{</span><span class="cm-null"> </span><span class="cm-variable">athlete</span><span class="cm-null">.</span><span class="cm-property">name</span><span class="cm-null"> </span><span class="cm-tag">}}</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-comment">{# (Events) #}</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-comment">{# Also broken, will not work: #}</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span> <span class="cm-attribute">@click:</span>=<span class="cm-string">athlete.myClickCallback</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-tag">{{</span><span class="cm-null"> </span><span class="cm-variable">athlete</span><span class="cm-null">.</span><span class="cm-property">name</span><span class="cm-null"> </span><span class="cm-tag">}}</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-comment">{# Correct, will work: #}</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span> <span class="cm-attribute">@click:</span>=<span class="cm-string">script.selectOne</span> <span class="cm-attribute">payload</span>=<span class="cm-string">"</span><span class="cm-tag">{{</span><span class="cm-null"> </span><span class="cm-variable">athlete</span><span class="cm-null">.</span><span class="cm-property">id</span><span class="cm-null"> </span><span class="cm-tag">}}</span><span class="cm-string">"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-tag">{{</span><span class="cm-null"> </span><span class="cm-variable">athlete</span><span class="cm-null">.</span><span class="cm-property">name</span><span class="cm-null"> </span><span class="cm-tag">}}</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-tag">{%</span><span class="cm-null"> </span><span class="cm-keyword">endfor</span><span class="cm-null"> </span><span class="cm-tag">%}</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">Template</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 50px; width: 1px; border-bottom: 0px solid transparent; top: 464px;"></div><div class="CodeMirror-gutters" style="display: none; height: 514px;"></div></div></div></div>
        </div>

        

    </div>
</div>



</mws-demo>

<blockquote>
    <p><strong>Why "payload"?</strong> Why does Modulo take this approach, vs
    something like React, that allows direct attachment of anonymous JavaScript
    functions? As any React developer knows by now, there are a lot of
    "footguns" (common mistakes) with attaching events like this, specifically
    because complexities with "this" context, anonymous functions, and bound
    functions with arguments can make introspection (e.g. interactive
    debugging) hard.</p>

    <p>The Modulo approach is always "DOM determines behavior".  Just by using
    "Inspect" in your browser's Developer Tools, you can examine or even modify
    the "payload" attribute while debugging event behavior. In other words,
    Modulo <em>tends to treat the DOM as the "source of truth"</em>, and thus
    derives it's behavior from properties on DOM elements.</p>
</blockquote>

    <p>The first attempt (HTML Attributes) uses a directive (<code>[component.dataProp]</code>, in
    this case using the colon <code>:</code> shortcut), in an attempt to "directly"
    attach the URL to href. The second attempt correctly uses the template variable
    with double curly braces to embed it as an actual HTML property.  The first
    attempt will fail because it fails to take into account that the directives
    will happen <em>after</em> rendering the template. That is, the resulting HTML
    will literally resemble something like this:
    “<code>&lt;a href:=athlete.url&gt;Steph Curry &lt;/a&gt;
    &lt;a href:=athlete.url&gt;Megan Rapinoe&lt;/a&gt;
    &lt;a href:=athlete.url&gt;Devante Adams&lt;/a&gt;</code>”.

    </p><p>In other words, the "athlete" variable <em>is a temporary Template
    variable in the for loop</em> (that is to say, not a variable in the
    <em>renderObj</em>), and will only be used at the templating step, and
    forgotten immediately after. Since directives are only invoked once
    templating is fully completed, there is no way to resolve the variable from
    the for loop.</p>


    <p>What is the proper use of the <code>[component.dataProp]</code>
    directive, you might ask? The proper use is for direct assignment or
    attachment of values that are not strings or numbers <em>at the top level
    of the renderObj</em>. Basically, anything that can't be conveniently
    serialized into a string attribute. The common usage is passing down
    complex nested data types as <code>Props</code> (i.e. without having to
    clutter the DOM and waste memory with a massive JSON object serialized as
    an attribute), or for attaching callbacks from the renderObj.</p>

    <p>We see such correct usage in the second (Events) "correct" example: It
    references <code>script.selectAthlete</code> which is at the global level.
    We can tell that it's at the global renderObj level since it starts with
    <code>script.</code>, referencing the contribution to the renderObj that
    was provided by the Script CPart. The issue with this, however, is that we
    won't know <em>which</em> button was clicked, since it references one
    universal <code>selectAthlete</code> function.
    This is solved by attaching some sort of ID reference to the DOM element as
    a "payload" so that the callback function knows which athlete was selected.
    This is the correct approach: It uses the DOM as a "source of truth" and is
    predictable in behavior, with no "hidden" functions getting attached.</p>

</div>


<!-- TODO The following documentation needs updating once we have a directives
configuration interface ... -->

<!--
<h3>Registering CPart directives with shortcuts</h3>

<p>If you are a CPart developer, you might want to register a shortcut along
with your CPart's directive. Note that this only applies to CPart developers:
Component developers should never create shortcuts for the script-tag based
custom directives used (which should be avoided to begin with).</p>


<p>See below for an example:</p>

<mws-Demo demotype="minipreview"
text='
<Template>
    Game Shop: 31 moneys<br />
    Avg Movie Creeps: 10 moneys<br />
    <button @click:=script.toggle>
        {% if state.show %}
        Hide controls (and trigger unmount callbacks)
        {% else %}
        Show controls (and trigger mount directive callbacks)
        {% endif %}
    </button> <br />
    {% if state.show %}
        <button %%%buy="GMC">(text is replaced)</button>
        <button %%%sell="GMC"></button>
        <button %%%long="AMC"></button>
        <button %%%short="AMC"></button>
    {% endif %}
</Template>

<State
    show:=false
></State>

<Script>
    function factoryCallback(partOptions, factory, loadObj)  {
        loadObj.component.directiveShortcuts.push([/^%%%/, "script.example"]);
    }

    function exampleMount(info) {
        console.log("Mounting directive:", info);
        const {el, value, attrName, rawName} = info;
        el.textContent = `${attrName} ${value}`;
        el.onclick = () => alert(attrName + "ing " + value);
    }
    function exampleUnmount(info) {
        console.log("Unmounting directive:", info);
    }
    function toggle() {
        state.show = !state.show;
    }
</Script>
'></mws-Demo>

<p><strong>Note:</strong> "Do as I say, not as I do": To keep the previous
example simple, we are demonstrating it's use within a script tag in a
component, but in general shortcuts are only intended for CPart directives, not
custom script tag directives.</p>
-->

</slot>
        </aside>
    </main>


<footer>
    <main>
        (C) 2022 - Michael Bethencourt - Documentation under LGPL 3.0
    </main>
</footer>



<script src="/_modulo/modulo-bundle-xhkg10f.js"></script><script>var _X = currentModulo.assets.invoke.bind(currentModulo.assets);
_X('xqf9b9l', ["x-demomodal"]);
_X('sg83u6', ["x-demochart"]);
_X('x1da3243', ["x-examplebtn"]);
_X('x33s3q', ["x-demoselector"]);
_X('433vtt', ["mws-page"]);
_X('4mpqrn', ["mws-projectinfo"]);
_X('x1aqc8h6', ["mws-devlognav"]);
_X('x1juvmkg', ["mws-docsidebar"]);
_X('x6nt2r0', ["mws-demo"]);
_X('xtg6cqb', ["mws-allexamples"]);
_X('l1gr4i', ["mws-section"]);
_X('17sct8m', ["docseg-templating_1"]);
_X('1mvqm2k', ["docseg-templating_preparecallback"]);
_X('x4kk41c', ["docseg-templating_comments"]);
_X('x14uqs09', ["docseg-templating_escaping"]);
_X('xif6qno', ["docseg-tutorial_p1"]);
_X('x1c4jlk3', ["docseg-tutorial_p2"]);
_X('x1gqlqhr', ["docseg-tutorial_p2_filters_demo"]);
_X('xpmn7oi', ["docseg-tutorial_p3_state_demo"]);
_X('1sc0e93', ["docseg-tutorial_p3_state_bind"]);
_X('14n8egj', ["eg-hello"]);
_X('r5jke9', ["eg-simple"]);
_X('18e8a6j', ["eg-todo"]);
_X('x1b5e73p', ["eg-json"]);
_X('x2b520g', ["eg-jsonarray"]);
_X('cd55r1', ["eg-githubapi"]);
_X('x1ii4dc3', ["eg-colorselector"]);
_X('f4cpaa', ["eg-datenumberpicker"]);
_X('x1g4uuhi', ["eg-primesieve"]);
_X('1vfteg8', ["eg-scatter"]);
_X('1ns7ff4', ["eg-flexibleform"]);
_X('x1m1b3bs', ["eg-flexibleformwithapi"]);
_X('8bv8j2', ["eg-components"]);
_X('x7jhpv4', ["eg-oscillatinggraph"]);
_X('xlrsjv0', ["eg-search"]);
_X('x1jlcjv6', ["eg-searchbox"]);
_X('x14gac81', ["eg-worldmap"]);
_X('4ita9', ["eg-memory"]);
_X('xao68n1', ["eg-conwaygameoflife"]);
</script></body></html>
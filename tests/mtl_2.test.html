<Component name="MTLTest2"><TestSuite >

<!-- Unit tests for MTL -->

<Test name="ensure class-based interface works">
    <script name="instance with new">
        const { Template } = modulo.registry.cparts;
        const instance = new Template("Testing testing 123");
        assert: instance
    </script>

    <script name="instance with new and has expected properties">
        const { Template } = modulo.registry.cparts;
        const instance = new Template("Testing testing 123");
        assert: instance.tags && instance.filters && instance.render
    </script>

    <script name="instance can render">
        const { Template } = modulo.registry.cparts;
        const text = "Testing testing 123";
        const instance = new Template(text);
        const result = instance.render({ });
        assert: result === text
    </script>


    <script name="can create 12 instances and render 10 in inconsistent ordering">
        const { Template } = modulo.registry.cparts;
        const instances = [];
        let i = 0;
        while (i++ < 12) {
            instances.push(new Template(`[ID#${ i }]`));
        }
        let result = '';
        let expected = '';
        i = 13;
        while (i-- > 8) { // render 5 in opposite order
            result += instances.pop().render();
            expected += `[ID#${ i }]`;
        }
        i = 0;
        while (i++ < 5) { // and second half in forward order
            result += instances.shift().render();
            expected += `[ID#${ i }]`;
        }
        assert: result === expected
    </script>
</Test>

</TestSuite></Component>
